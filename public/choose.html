<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Choose Your Mentor â€” PhiloSim</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&family=DM+Sans:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
        
        :root {
            --gold: #d4a853;
            --gold-light: #e8c97a;
            --gold-dark: #b8922f;
            --bg-primary: #05050a;
            --bg-card: #0d0d14;
            --bg-card-hover: #12121c;
            --purple: #6366f1;
            --purple-light: #818cf8;
            --text-primary: #f0ece4;
            --text-secondary: #9b978f;
            --text-muted: #5a574f;
            --border: rgba(212, 168, 83, 0.12);
            --border-hover: rgba(212, 168, 83, 0.3);
            --success: #22c55e;
            --overlay: rgba(5, 5, 10, 0.85);
        }

        body {
            background: var(--bg-primary);
            color: var(--text-primary);
            font-family: 'DM Sans', sans-serif;
            min-height: 100vh;
            overflow-x: hidden;
        }

        h1, h2, h3, h4, h5 {
            font-family: 'Space Grotesk', sans-serif;
        }

        /* ===== SIDEBAR ===== */
        .sidebar {
            position: fixed;
            left: 0; top: 0;
            width: 220px;
            height: 100vh;
            background: var(--bg-card);
            border-right: 1px solid var(--border);
            padding: 24px 16px;
            display: flex;
            flex-direction: column;
            z-index: 100;
            transition: transform 0.3s ease;
        }

        .sidebar-brand {
            font-family: 'Space Grotesk', sans-serif;
            font-size: 20px;
            font-weight: 700;
            color: var(--gold);
            margin-bottom: 8px;
            letter-spacing: -0.5px;
        }

        .sidebar-brand span { color: var(--text-secondary); font-weight: 400; font-size: 12px; display: block; margin-top: 2px; }

        .sidebar-nav { margin-top: 32px; display: flex; flex-direction: column; gap: 4px; flex: 1; }

        .sidebar-nav a {
            display: flex; align-items: center; gap: 10px;
            padding: 10px 12px; border-radius: 8px;
            color: var(--text-secondary); text-decoration: none;
            font-size: 14px; font-weight: 500;
            transition: all 0.2s;
        }

        .sidebar-nav a:hover, .sidebar-nav a.active {
            background: rgba(212, 168, 83, 0.08);
            color: var(--gold);
        }

        .sidebar-nav a svg { width: 18px; height: 18px; flex-shrink: 0; }

        .lang-toggle {
            display: flex; gap: 4px;
            padding: 4px; background: rgba(255,255,255,0.04);
            border-radius: 8px; margin-top: 16px;
        }

        .lang-btn {
            flex: 1; padding: 6px 0; border: none;
            background: transparent; color: var(--text-muted);
            font-size: 12px; font-weight: 600;
            cursor: pointer; border-radius: 6px;
            transition: all 0.2s;
        }

        .lang-btn.active { background: var(--gold); color: var(--bg-primary); }

        /* ===== HAMBURGER ===== */
        .hamburger {
            display: none; position: fixed;
            top: 16px; left: 16px; z-index: 200;
            background: var(--bg-card); border: 1px solid var(--border);
            border-radius: 8px; padding: 10px;
            cursor: pointer; color: var(--gold);
        }

        .hamburger svg { width: 20px; height: 20px; }

        .sidebar-overlay {
            display: none; position: fixed; inset: 0;
            background: var(--overlay); z-index: 99;
        }

        /* ===== MAIN CONTENT ===== */
        .main {
            margin-left: 220px;
            padding: 48px 40px;
            max-width: 1200px;
        }

        .page-header {
            text-align: center;
            margin-bottom: 56px;
        }

        .page-header h1 {
            font-size: 40px;
            font-weight: 700;
            letter-spacing: -1px;
            margin-bottom: 12px;
            background: linear-gradient(135deg, var(--gold-light), var(--gold), var(--gold-dark));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .page-header p {
            font-size: 17px;
            color: var(--text-secondary);
            max-width: 560px;
            margin: 0 auto;
            line-height: 1.6;
        }

        /* ===== PHILOSOPHER GRID ===== */
        .philosophers-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 24px;
        }

        /* ===== PHILOSOPHER CARD ===== */
        .philosopher-card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 32px 28px;
            position: relative;
            overflow: hidden;
            transition: all 0.35s ease;
            display: flex;
            flex-direction: column;
        }

        .philosopher-card::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0;
            height: 3px;
            background: linear-gradient(90deg, transparent, var(--gold), transparent);
            opacity: 0;
            transition: opacity 0.35s;
        }

        .philosopher-card:hover {
            border-color: var(--border-hover);
            background: var(--bg-card-hover);
            transform: translateY(-4px);
        }

        .philosopher-card:hover::before { opacity: 1; }

        .philosopher-card.active {
            border-color: rgba(212, 168, 83, 0.4);
        }

        .philosopher-card.active::before { opacity: 1; }

        .philosopher-card.coming-soon {
            opacity: 0.7;
        }

        .philosopher-card.coming-soon:hover {
            opacity: 0.85;
        }

        /* Card header */
        .card-top {
            display: flex;
            align-items: flex-start;
            gap: 18px;
            margin-bottom: 20px;
        }

        .philosopher-avatar {
            width: 72px;
            height: 72px;
            border-radius: 50%;
            background: linear-gradient(135deg, rgba(212,168,83,0.15), rgba(99,102,241,0.1));
            border: 2px solid var(--border);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            flex-shrink: 0;
            position: relative;
            overflow: hidden;
        }

        .philosopher-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 50%;
        }

        .card-info { flex: 1; }

        .card-info h3 {
            font-size: 22px;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 2px;
            letter-spacing: -0.3px;
        }

        .card-info .era {
            font-size: 13px;
            color: var(--text-muted);
            font-weight: 500;
        }

        .status-badge {
            display: inline-flex;
            align-items: center;
            gap: 5px;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .status-badge.available {
            background: rgba(34, 197, 94, 0.12);
            color: var(--success);
        }

        .status-badge.available::before {
            content: '';
            width: 6px; height: 6px;
            border-radius: 50%;
            background: var(--success);
            animation: pulse 2s infinite;
        }

        .status-badge.coming {
            background: rgba(99, 102, 241, 0.12);
            color: var(--purple-light);
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.4; }
        }

        /* Card body */
        .card-quote {
            font-style: italic;
            color: var(--gold);
            font-size: 15px;
            line-height: 1.5;
            margin-bottom: 16px;
            padding-left: 14px;
            border-left: 2px solid rgba(212, 168, 83, 0.3);
        }

        .card-description {
            font-size: 14px;
            color: var(--text-secondary);
            line-height: 1.65;
            margin-bottom: 20px;
            flex: 1;
        }

        .card-topics {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            margin-bottom: 24px;
        }

        .topic-tag {
            padding: 4px 10px;
            border-radius: 6px;
            font-size: 11px;
            font-weight: 600;
            background: rgba(212, 168, 83, 0.08);
            color: var(--gold);
            border: 1px solid rgba(212, 168, 83, 0.12);
        }

        .coming-soon .topic-tag {
            background: rgba(99, 102, 241, 0.06);
            color: var(--purple-light);
            border-color: rgba(99, 102, 241, 0.12);
        }

        /* Card actions */
        .card-actions { margin-top: auto; }

        .btn-begin {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            width: 100%;
            padding: 14px 24px;
            border: none;
            border-radius: 10px;
            font-family: 'Space Grotesk', sans-serif;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.25s;
            text-decoration: none;
        }

        .btn-begin.primary {
            background: linear-gradient(135deg, var(--gold), var(--gold-dark));
            color: var(--bg-primary);
        }

        .btn-begin.primary:hover {
            background: linear-gradient(135deg, var(--gold-light), var(--gold));
            transform: scale(1.02);
            box-shadow: 0 4px 20px rgba(212, 168, 83, 0.25);
        }

        .btn-begin.notify {
            background: rgba(99, 102, 241, 0.1);
            color: var(--purple-light);
            border: 1px solid rgba(99, 102, 241, 0.2);
        }

        .btn-begin.notify:hover {
            background: rgba(99, 102, 241, 0.18);
            border-color: rgba(99, 102, 241, 0.35);
        }

        .btn-begin.notify.notified {
            background: rgba(34, 197, 94, 0.1);
            color: var(--success);
            border-color: rgba(34, 197, 94, 0.2);
            cursor: default;
        }

        .btn-begin svg { width: 16px; height: 16px; }

        /* ===== NOTIFY MODAL ===== */
        .modal-overlay {
            display: none;
            position: fixed; inset: 0;
            background: var(--overlay);
            z-index: 500;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .modal-overlay.open { display: flex; }

        .modal-box {
            background: var(--bg-card);
            border: 1px solid var(--border-hover);
            border-radius: 16px;
            padding: 36px;
            max-width: 420px;
            width: 100%;
            text-align: center;
            animation: modalIn 0.3s ease;
        }

        @keyframes modalIn {
            from { opacity: 0; transform: scale(0.95) translateY(8px); }
            to { opacity: 1; transform: scale(1) translateY(0); }
        }

        .modal-box .philosopher-avatar {
            width: 64px; height: 64px;
            margin: 0 auto 16px;
            font-size: 28px;
        }

        .modal-box h3 {
            font-size: 22px;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 8px;
        }

        .modal-box p {
            font-size: 14px;
            color: var(--text-secondary);
            line-height: 1.6;
            margin-bottom: 24px;
        }

        .modal-actions { display: flex; gap: 10px; }

        .modal-btn {
            flex: 1; padding: 12px;
            border-radius: 8px;
            font-family: 'Space Grotesk', sans-serif;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            border: none;
            transition: all 0.2s;
        }

        .modal-btn.cancel {
            background: rgba(255,255,255,0.05);
            color: var(--text-secondary);
        }

        .modal-btn.confirm {
            background: var(--purple);
            color: white;
        }

        .modal-btn.confirm:hover { background: var(--purple-light); }

        /* ===== TOAST ===== */
        .toast {
            position: fixed;
            bottom: 24px;
            right: 24px;
            background: var(--bg-card);
            border: 1px solid rgba(34, 197, 94, 0.3);
            border-radius: 10px;
            padding: 14px 20px;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 14px;
            color: var(--success);
            z-index: 600;
            transform: translateY(100px);
            opacity: 0;
            transition: all 0.4s ease;
        }

        .toast.show { transform: translateY(0); opacity: 1; }

        .toast svg { width: 18px; height: 18px; flex-shrink: 0; }

        /* ===== FADE-IN ANIMATIONS ===== */
        .fade-up {
            opacity: 0;
            transform: translateY(20px);
            animation: fadeUp 0.5s ease forwards;
        }

        @keyframes fadeUp {
            to { opacity: 1; transform: translateY(0); }
        }

        .philosopher-card:nth-child(1) { animation-delay: 0.05s; }
        .philosopher-card:nth-child(2) { animation-delay: 0.12s; }
        .philosopher-card:nth-child(3) { animation-delay: 0.19s; }
        .philosopher-card:nth-child(4) { animation-delay: 0.26s; }
        .philosopher-card:nth-child(5) { animation-delay: 0.33s; }
        .philosopher-card:nth-child(6) { animation-delay: 0.40s; }

        /* ===== RESPONSIVE ===== */
        @media (max-width: 768px) {
            .sidebar { transform: translateX(-100%); }
            .sidebar.open { transform: translateX(0); }
            .sidebar-overlay.open { display: block; }
            .hamburger { display: flex; }
            .main { margin-left: 0; padding: 80px 20px 40px; }
            .page-header h1 { font-size: 28px; }
            .philosophers-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>

    <!-- Hamburger -->
    <button class="hamburger" onclick="toggleSidebar()">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="18" x2="21" y2="18"/></svg>
    </button>

    <!-- Sidebar Overlay -->
    <div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>

    <!-- Sidebar -->
    <nav class="sidebar" id="sidebar">
        <div class="sidebar-brand">
            PhiloSim
            <span>by Panda Projet</span>
        </div>
        <div class="sidebar-nav">
            <a href="/choose" class="active">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M12 8v4l2 2"/></svg>
                <span data-i18n="nav_mentors">Choose Mentor</span>
            </a>
            <a href="/dashboard">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="7" height="7" rx="1"/><rect x="14" y="3" width="7" height="7" rx="1"/><rect x="3" y="14" width="7" height="7" rx="1"/><rect x="14" y="14" width="7" height="7" rx="1"/></svg>
                <span data-i18n="nav_dashboard">Dashboard</span>
            </a>
            <a href="/">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 12l9-9 9 9"/><path d="M5 10v10a1 1 0 001 1h3m10-11v10a1 1 0 01-1 1h-3"/></svg>
                <span data-i18n="nav_home">Home</span>
            </a>
            <a href="#" onclick="logout()" style="margin-top: auto;">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 21H5a2 2 0 01-2-2V5a2 2 0 012-2h4"/><polyline points="16,17 21,12 16,7"/><line x1="21" y1="12" x2="9" y2="12"/></svg>
                <span data-i18n="nav_logout">Logout</span>
            </a>
        </div>
        <div class="lang-toggle">
            <button class="lang-btn" id="btnEN" onclick="setLang('en')">EN</button>
            <button class="lang-btn" id="btnFR" onclick="setLang('fr')">FR</button>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main">
        <div class="page-header fade-up">
            <h1 data-i18n="page_title">Choose Your Mentor</h1>
            <p data-i18n="page_subtitle">Each philosopher offers a unique lens through which to examine life's toughest decisions. Who will guide your journey?</p>
        </div>

        <div class="philosophers-grid" id="philosophersGrid">
            <!-- Cards injected by JS -->
        </div>
    </main>

    <!-- Notify Modal -->
    <div class="modal-overlay" id="notifyModal">
        <div class="modal-box">
            <div class="philosopher-avatar" id="modalAvatar"></div>
            <h3 id="modalTitle"></h3>
            <p id="modalDesc"></p>
            <div class="modal-actions">
                <button class="modal-btn cancel" onclick="closeNotifyModal()" data-i18n="modal_cancel">Cancel</button>
                <button class="modal-btn confirm" onclick="confirmNotify()" data-i18n="modal_notify">Notify Me</button>
            </div>
        </div>
    </div>

    <!-- Toast -->
    <div class="toast" id="toast">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20 6L9 17l-5-5"/></svg>
        <span id="toastMsg"></span>
    </div>

    <script>
        // ===== COOKIE â†’ LOCALSTORAGE BRIDGE =====
        (function() {
            const cookies = document.cookie.split(';');
            for (const c of cookies) {
                const [key, val] = c.trim().split('=');
                if (key === 'auth_token' && val) {
                    localStorage.setItem('auth_token', val);
                    document.cookie = 'auth_token=; path=/; max-age=0';
                    break;
                }
            }
        })();

        // ===== AUTH CHECK =====
        const token = localStorage.getItem('auth_token');
        if (!token) { window.location.href = '/'; }

        // ===== i18n =====
        const i18n = {
            en: {
                nav_mentors: 'Choose Mentor',
                nav_dashboard: 'Dashboard',
                nav_home: 'Home',
                nav_logout: 'Logout',
                page_title: 'Choose Your Mentor',
                page_subtitle: 'Each philosopher offers a unique lens through which to examine life\'s toughest decisions. Who will guide your journey?',
                status_available: 'Available Now',
                status_coming: 'Coming Soon',
                btn_begin: 'Begin Journey',
                btn_discover: 'Discover',
                btn_notify: 'Notify Me When Ready',
                btn_notified: 'You\'ll Be Notified!',
                modal_cancel: 'Cancel',
                modal_notify: 'Notify Me',
                modal_confirm_title: 'wants to know:',
                modal_confirm_desc: 'We\'ll send you an email as soon as this mentor is available. Ready to be among the first?',
                toast_success: 'You\'ll be the first to know when {name} is ready!'
            },
            fr: {
                nav_mentors: 'Choisir un Mentor',
                nav_dashboard: 'Tableau de bord',
                nav_home: 'Accueil',
                nav_logout: 'DÃ©connexion',
                page_title: 'Choisissez Votre Mentor',
                page_subtitle: 'Chaque philosophe offre une perspective unique pour examiner les dÃ©cisions les plus difficiles de la vie. Qui guidera votre parcours?',
                status_available: 'Disponible',
                status_coming: 'BientÃ´t disponible',
                btn_begin: 'Commencer le Parcours',
                btn_discover: 'DÃ©couvrir',
                btn_notify: 'Me PrÃ©venir',
                btn_notified: 'Vous serez prÃ©venu!',
                modal_cancel: 'Annuler',
                modal_notify: 'Me PrÃ©venir',
                modal_confirm_title: 'veut savoir:',
                modal_confirm_desc: 'Nous vous enverrons un courriel dÃ¨s que ce mentor sera disponible. PrÃªt Ã  Ãªtre parmi les premiers?',
                toast_success: 'Vous serez le premier Ã  savoir quand {name} sera prÃªt!'
            }
        };

        let currentLang = localStorage.getItem('philosim_lang') || 'en';

        function t(key) { return i18n[currentLang][key] || i18n['en'][key] || key; }

        function setLang(lang) {
            currentLang = lang;
            localStorage.setItem('philosim_lang', lang);
            document.getElementById('btnEN').classList.toggle('active', lang === 'en');
            document.getElementById('btnFR').classList.toggle('active', lang === 'fr');
            applyTranslations();
            renderCards();
        }

        function applyTranslations() {
            document.querySelectorAll('[data-i18n]').forEach(el => {
                const key = el.getAttribute('data-i18n');
                if (i18n[currentLang][key]) el.textContent = i18n[currentLang][key];
            });
        }

        // ===== PHILOSOPHER DATA =====
        const philosophers = [
            {
                id: 'socrates',
                name: 'Socrates',
                name_fr: 'Socrate',
                era: '469â€“399 BC',
                era_fr: '469â€“399 av. J.-C.',
                emoji: 'ðŸ›ï¸',
                avatar: '/socrates.png',
                quote: { en: '"The unexamined life is not worth living."', fr: 'Â« Une vie sans examen ne vaut pas la peine d\'Ãªtre vÃ©cue. Â»' },
                description: {
                    en: 'Master the Socratic method through real-world dilemmas. Socrates will challenge your assumptions, question your beliefs, and guide you toward deeper self-knowledge.',
                    fr: 'MaÃ®trisez la mÃ©thode socratique Ã  travers des dilemmes du monde rÃ©el. Socrate remettra en question vos hypothÃ¨ses et vous guidera vers une connaissance plus profonde de vous-mÃªme.'
                },
                topics: {
                    en: ['Ethics', 'Self-Knowledge', 'Critical Thinking', 'Dialogue'],
                    fr: ['Ã‰thique', 'Connaissance de soi', 'PensÃ©e critique', 'Dialogue']
                },
                status: 'available'
            },
            {
                id: 'plato',
                name: 'Plato',
                name_fr: 'Platon',
                era: '428â€“348 BC',
                era_fr: '428â€“348 av. J.-C.',
                emoji: 'ðŸ“œ',
                avatar: '/plato.png',
                quote: { en: '"The measure of a man is what he does with power."', fr: 'Â« La mesure d\'un homme est ce qu\'il fait du pouvoir. Â»' },
                description: {
                    en: 'Explore the world of Forms and ideal governance. Plato will lead you through allegories of justice, truth, and the nature of reality itself.',
                    fr: 'Explorez le monde des Formes et de la gouvernance idÃ©ale. Platon vous guidera Ã  travers des allÃ©gories sur la justice, la vÃ©ritÃ© et la nature de la rÃ©alitÃ©.'
                },
                topics: {
                    en: ['Justice', 'Ideal Forms', 'Governance', 'Truth'],
                    fr: ['Justice', 'Formes idÃ©ales', 'Gouvernance', 'VÃ©ritÃ©']
                },
                status: 'coming'
            },
            {
                id: 'aristotle',
                name: 'Aristotle',
                name_fr: 'Aristote',
                era: '384â€“322 BC',
                era_fr: '384â€“322 av. J.-C.',
                emoji: 'ðŸ“š',
                avatar: '/aristotle.png',
                quote: { en: '"We are what we repeatedly do. Excellence, then, is not an act, but a habit."', fr: 'Â« Nous sommes ce que nous faisons de maniÃ¨re rÃ©pÃ©tÃ©e. L\'excellence n\'est donc pas un acte, mais une habitude. Â»' },
                description: {
                    en: 'Develop practical wisdom through the pursuit of virtue. Aristotle will guide you to find the golden mean in every decision, building character through action.',
                    fr: 'DÃ©veloppez la sagesse pratique Ã  travers la recherche de la vertu. Aristote vous guidera pour trouver le juste milieu dans chaque dÃ©cision, forgeant le caractÃ¨re par l\'action.'
                },
                topics: {
                    en: ['Virtue Ethics', 'Practical Wisdom', 'Leadership', 'Golden Mean'],
                    fr: ['Ã‰thique de la vertu', 'Sagesse pratique', 'Leadership', 'Juste milieu']
                },
                status: 'coming'
            },
            {
                id: 'kant',
                name: 'Immanuel Kant',
                name_fr: 'Emmanuel Kant',
                era: '1724â€“1804',
                emoji: 'âš–ï¸',
                avatar: '/kant.png',
                quote: { en: '"Act only according to that maxim whereby you can will it become a universal law."', fr: 'Â« Agis seulement selon la maxime qui fait que tu puisses vouloir qu\'elle devienne une loi universelle. Â»' },
                description: {
                    en: 'Navigate moral duty through the categorical imperative. Kant will test your reasoning with scenarios where duty, consequences, and universal principles collide.',
                    fr: 'Naviguez le devoir moral Ã  travers l\'impÃ©ratif catÃ©gorique. Kant mettra votre raisonnement Ã  l\'Ã©preuve dans des scÃ©narios oÃ¹ devoir, consÃ©quences et principes universels s\'affrontent.'
                },
                topics: {
                    en: ['Moral Duty', 'Reason', 'Universal Law', 'Autonomy'],
                    fr: ['Devoir moral', 'Raison', 'Loi universelle', 'Autonomie']
                },
                status: 'coming'
            },
            {
                id: 'nietzsche',
                name: 'Friedrich Nietzsche',
                name_fr: 'Friedrich Nietzsche',
                era: '1844â€“1900',
                emoji: 'ðŸ”¥',
                avatar: '/nietzsche.png',
                quote: { en: '"He who has a why to live can bear almost any how."', fr: 'Â« Celui qui a un pourquoi de vivre peut supporter presque n\'importe quel comment. Â»' },
                description: {
                    en: 'Confront the will to power and the creation of meaning. Nietzsche will push you to overcome yourself and forge your own values in a world without guarantees.',
                    fr: 'Affrontez la volontÃ© de puissance et la crÃ©ation de sens. Nietzsche vous poussera Ã  vous surpasser et Ã  forger vos propres valeurs dans un monde sans garanties.'
                },
                topics: {
                    en: ['Will to Power', 'Self-Overcoming', 'Meaning', 'Authenticity'],
                    fr: ['VolontÃ© de puissance', 'DÃ©passement de soi', 'Sens', 'AuthenticitÃ©']
                },
                status: 'coming'
            },
            {
                id: 'beauvoir',
                name: 'Simone de Beauvoir',
                name_fr: 'Simone de Beauvoir',
                era: '1908â€“1986',
                emoji: 'âœŠ',
                avatar: '/beauvoir.png',
                quote: { en: '"One is not born, but rather becomes, a woman."', fr: 'Â« On ne naÃ®t pas femme, on le devient. Â»' },
                description: {
                    en: 'Explore freedom, responsibility, and the ethics of ambiguity. Beauvoir will challenge you to embrace radical freedom while confronting the weight of existence.',
                    fr: 'Explorez la libertÃ©, la responsabilitÃ© et l\'Ã©thique de l\'ambiguÃ¯tÃ©. Beauvoir vous poussera Ã  embrasser la libertÃ© radicale tout en affrontant le poids de l\'existence.'
                },
                topics: {
                    en: ['Freedom', 'Existentialism', 'Ethics', 'Identity'],
                    fr: ['LibertÃ©', 'Existentialisme', 'Ã‰thique', 'IdentitÃ©']
                },
                status: 'coming'
            }
        ];

        // ===== TRACK NOTIFIED PHILOSOPHERS =====
        let notifiedPhilosophers = JSON.parse(localStorage.getItem('philosim_notified') || '[]');

        // ===== RENDER CARDS =====
        function renderCards() {
            const grid = document.getElementById('philosophersGrid');
            grid.innerHTML = '';

            philosophers.forEach((p, i) => {
                const isAvailable = p.status === 'available';
                const isNotified = notifiedPhilosophers.includes(p.id);
                const name = currentLang === 'fr' && p.name_fr ? p.name_fr : p.name;
                const era = currentLang === 'fr' && p.era_fr ? p.era_fr : p.era;

                const card = document.createElement('div');
                card.className = `philosopher-card fade-up ${isAvailable ? 'active' : 'coming-soon'}`;
                card.style.animationDelay = `${i * 0.07}s`;

                const avatarContent = p.avatar
                    ? `<img src="${p.avatar}" alt="${name}" onerror="this.parentElement.textContent='${p.emoji}'">`
                    : p.emoji;

                let actionBtn;
                if (isAvailable) {
                    actionBtn = `<a href="/philosopher?id=${p.id}" class="btn-begin primary">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polygon points="5,3 19,12 5,21"/></svg>
                        ${t('btn_begin')}
                    </a>`;
                } else {
                    actionBtn = `<a href="/philosopher?id=${p.id}" class="btn-begin notify">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M15 3h6v6"/><path d="M10 14L21 3"/><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/></svg>
                        ${t('btn_discover')}
                    </a>`;
                }

                card.innerHTML = `
                    <div class="card-top">
                        <div class="philosopher-avatar">${avatarContent}</div>
                        <div class="card-info">
                            <h3>${name}</h3>
                            <div class="era">${era}</div>
                            <div style="margin-top: 8px;">
                                <span class="status-badge ${isAvailable ? 'available' : 'coming'}">
                                    ${isAvailable ? t('status_available') : t('status_coming')}
                                </span>
                            </div>
                        </div>
                    </div>
                    <div class="card-quote">${p.quote[currentLang] || p.quote.en}</div>
                    <div class="card-description">${p.description[currentLang] || p.description.en}</div>
                    <div class="card-topics">
                        ${(p.topics[currentLang] || p.topics.en).map(t => `<span class="topic-tag">${t}</span>`).join('')}
                    </div>
                    <div class="card-actions">${actionBtn}</div>
                `;

                grid.appendChild(card);
            });
        }

        // ===== NOTIFY MODAL =====
        let pendingNotifyId = null;

        function openNotifyModal(philosopherId) {
            const p = philosophers.find(x => x.id === philosopherId);
            if (!p) return;
            pendingNotifyId = philosopherId;

            const name = currentLang === 'fr' && p.name_fr ? p.name_fr : p.name;
            document.getElementById('modalAvatar').textContent = p.emoji;
            document.getElementById('modalTitle').textContent = name;
            document.getElementById('modalDesc').textContent = t('modal_confirm_desc');
            document.getElementById('notifyModal').classList.add('open');
        }

        function closeNotifyModal() {
            document.getElementById('notifyModal').classList.remove('open');
            pendingNotifyId = null;
        }

        async function confirmNotify() {
            if (!pendingNotifyId) return;
            const philosopherId = pendingNotifyId;
            const p = philosophers.find(x => x.id === philosopherId);
            const name = currentLang === 'fr' && p.name_fr ? p.name_fr : p.name;

            // Save to backend
            try {
                await fetch('/api/notify', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${token}`
                    },
                    body: JSON.stringify({ philosopher_id: philosopherId })
                });
            } catch (e) {
                console.warn('Notify API not available, saving locally only');
            }

            // Save locally
            notifiedPhilosophers.push(philosopherId);
            localStorage.setItem('philosim_notified', JSON.stringify(notifiedPhilosophers));

            closeNotifyModal();
            renderCards();
            showToast(t('toast_success').replace('{name}', name));
        }

        function showToast(msg) {
            const toast = document.getElementById('toast');
            document.getElementById('toastMsg').textContent = msg;
            toast.classList.add('show');
            setTimeout(() => toast.classList.remove('show'), 3500);
        }

        // ===== SIDEBAR =====
        function toggleSidebar() {
            document.getElementById('sidebar').classList.toggle('open');
            document.getElementById('sidebarOverlay').classList.toggle('open');
        }

        function logout() {
            localStorage.removeItem('auth_token');
            window.location.href = '/';
        }

        // ===== INIT =====
        document.addEventListener('DOMContentLoaded', () => {
            setLang(currentLang);
            renderCards();
        });
    </script>
</body>
</html>
